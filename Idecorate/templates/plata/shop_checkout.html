{% extends "base.html" %}
{% load i18n plata_tags idecorate_interface humanize widget_tweaks %}
{% block title %}iDecorate Wedding{% endblock %}
{%  block style %}
<link rel="stylesheet" type="text/css" href="/media/interface/css/shop_checkout.css">
{% endblock %}
{% block content %}
<div id="content" class="clearfix checkout">
	<h3>Checkout</h3>
	<div class="clearfix orderWrap">
		
		{% if orderform.errors %}
		<div class="clearfix errorBlock">
			<a href="" class="closeX">X</a>
			<h4>Please correct the following errors:</h4>
			<ol>
	          {% for e in orderform.billing_first_name.errors %}
	            <li>{{ e }}</li>
	          {% endfor %}
	          {% for e in orderform.billing_last_name.errors %}
	            <li>{{ e }}</li>
	          {% endfor %}
	          {% for e in orderform.email.errors %}
	            <li>{{ e }}</li>
	          {% endfor %}
	          {% for e in orderform.shipping_address.errors %}
	            <li>{{ e }}</li>
	          {% endfor %}
	          {% for e in orderform.shipping_zip_code.errors %}
	            <li>{{ e }}</li>
	          {% endfor %}
	          {% for e in orderform.billing_address.errors %}
	            <li>{{ e }}</li>
	          {% endfor %}
	          {% for e in orderform.billing_zip_code.errors %}
	            <li>{{ e }}</li>
	          {% endfor %}
	          {% for e in orderform.shipping_date.errors %}
	            <li>{{ e }}</li>
	          {% endfor %}
			</ol>
		</div>
		{% endif %}
		<fieldset>
			<legend>Your Order</legend>
			<table>
				<thead>
					<tr>
						<th></th>
						<th>Unit Cost</th>
						<th>Quantity</th>
						<th>Total Cost</th>
					</th>
				</thead>
				<tbody>
					{{ order.items|generate_product_order_list:order }}
				</tbody>
				<tfoot>
					<tr>
						<td></td>
						<td></td>
						<td>
							<p>{{ guest_table.guests }} Guests</p>
							<p>{{ guest_table.tables }} Tables</p>
						</td>
						<td>
							<p><!-- + $100 Shipping Fee -->&nbsp;</p>
							<p>Total: ${{ order.total|floatformat:2|intcomma }}</p>
							<button type="button" id="edit_button">Edit</button>
						</td>
					</tr>
				</tfoot>
			</table>
		</fieldset>
	</div>
	<form method="post" action=".">
		{% csrf_token %}
		<input type="hidden" name="_checkout" value="1" />
		<div class="clearfix loginDetails">
			<h4>Are you a returning customer?</h4>
			<p align="justify">If you have previously placed an order with us, no need to fill in your address and personal details again. Just login and choose your preferred payment method and you're done!</p>
			<p align="justify">If you're a new customer, we'll automatically create an account for you after you have finished your order.</p>
				<input type="text" placeholder="Email" />
				<input type="password" placeholder="Password" />
				<input type="submit" value="Login" class="submit" />
				<a href="#">Forgot your password?</a>
		</div>
		<div class="clearfix information">
			<fieldset class="personal">
				<legend>Personal Information</legend>
					<div class="clearfix">
						<label>Salutations</label>
						{{ orderform.billing_salutation }}
					</div>
					<div class="clearfix">
						<label>First Name</label>
						{{ orderform.billing_first_name }}
					</div>
					<div class="clearfix">
						<label>Last Name</label>
						{{ orderform.billing_last_name }}
					</div>
					<div class="clearfix">
						<label>Email</label>
						{{ orderform.email }}
					</div>
			</fieldset>
			<fieldset class="delivery">
				<legend>Delivery Address</legend>
					<div class="clearfix">
						<label>Address 1</label>
						{{ orderform.shipping_address }}
					</div>
					<div class="clearfix">
						<label>Address 2</label>
						{{ orderform.shipping_address2 }}
					</div>
					<div class="clearfix">
						{{ orderform.shipping_state|add_class:"districtList" }}
						<label>State</label>
					</div>
					<div class="clearfix">
						<label>City</label>
						{{ orderform.shipping_city|add_class:"districtList" }}
					</div>
					<div class="clearfix">
						<label>Postal Code</label>
						{{ orderform.shipping_zip_code }}
					</div>
					{{ orderform.shipping_same_as_billing }} My delivery address is the same as my billing address.
			</fieldset>
		</div>
		<div class="clearfix deliveryDetails">
			<fieldset class="deliveryDate">
				<legend>Delivery Date</legend>
					{{ orderform.shipping_date|attr:"placeholder:Date"|attr:"id:datepicker"|attr:"readonly:readonly" }}
				{{ "delivery_date_note"|get_checkout_page_info }}
			</fieldset>
			<fieldset class="delivery paymentMethod" id="billing_orig">
				<legend>Billing Address</legend>
				<form>
					<div class="clearfix">
						<label>Address 1</label>
						{{ orderform.billing_address }}
					</div>
					<div class="clearfix">
						<label>Address 2</label>
						{{ orderform.billing_address2 }}
					</div>
					<div class="clearfix">
						<label>State</label>
						{{ orderform.billing_state|add_class:"districtList" }}
					</div>
					<div class="clearfix">
						<label>City</label>
						{{ orderform.billing_city|add_class:"districtList" }}
					</div>
					<div class="clearfix">
						<label>Postal Code</label>
						{{ orderform.billing_zip_code }}
					</div>
			</fieldset>
			<!--
			<fieldset class="paymentMethod">
				<legend>Payment Method</legend>
					<div class="clearfix">
						<input type="radio" name="payment_type">
						<label>Paypal</label>
						<img src="http://sgentrepreneurs.com/wp-content/uploads/2012/02/paypal.jpg" width="80" align="bottom" />
					</div>
					<div class="clearfix">
						<input type="radio" name="payment_type">
						<label>VISA/Mastercard</label>
						<img src="http://www.ramps-to-runway.com/MasterCard-Visa.jpeg" width="80" />
					</div>
					<div class="clearfix">
						<input type="radio" name="payment_type">
						<label>American Express</label>
						<img src="http://mfwasia.com/wp-content/uploads/2011/03/mfw_americanexpress.jpg" width="40" />
					</div>
			</fieldset>
			-->
		</div>
	<div class="clearfix inquiry">
		<fieldset class="question">
			<legend>Any Questions?</legend>
			<p align="justify">{{ "any_question"|get_checkout_page_info }}</p>
		</fieldset>
		<fieldset class="paymentMethod2" id="payment_orig">
			<legend>Payment Method</legend>
				<div class="clearfix">
					<input type="radio" name="payment_type">
					<label>Paypal</label>
					<img src="http://sgentrepreneurs.com/wp-content/uploads/2012/02/paypal.jpg" width="80" align="bottom" />
				</div>
				<div class="clearfix">
					<input type="radio" name="payment_type">
					<label>VISA/Mastercard</label>
					<img src="http://www.ramps-to-runway.com/MasterCard-Visa.jpeg" width="80" />
				</div>
				<div class="clearfix">
					<input type="radio" name="payment_type">
					<label>American Express</label>
					<img src="http://mfwasia.com/wp-content/uploads/2011/03/mfw_americanexpress.jpg" width="40" />
				</div>
		</fieldset>
	</div>
	<div class="clearfix disclaimer">
		<p align="justify">{{ "t_and_c"|get_checkout_page_info }}</p>
		<button type="submit">Proceed to Payment</button>
	</div>
	</form>
</div>
{% endblock %}
{% block javascripts %}
<script type="text/javascript">
BILLING = '';
PAYMENT = '';

	$(function(){

		$('#edit_button').click(function(e){

			window.location = '{% url styleboard %}#buy-tab';
			
		});

		$('#id_order-shipping_same_as_billing').click(function(e){

			elementChangePosition()

		});

		BILLING = $('#billing_orig').html();
		PAYMENT = $('#payment_orig').html();

		resizeInfos();
		elementChangePosition();
	});

	function resizeInfos() {
		var deliveryDateH = $('.deliveryDate').outerHeight(true),
			paymentMethodH = $('.paymentMethod').outerHeight(true),
			paymentMethodH2 = $('.paymentMethod2').outerHeight(true),
			questionH = $('.question').outerHeight(true);

		if(deliveryDateH > paymentMethodH){
			$('.deliveryDate').height(deliveryDateH);
			$('.paymentMethod').height(deliveryDateH);
		}else{
			$('.deliveryDate').height(paymentMethodH);
			$('.paymentMethod').height(paymentMethodH);
		}

		if(questionH > paymentMethodH2){
			$('.question').height(paymentMethodH2);
			$('.paymentMethod2').height(paymentMethodH2);
		}else{
			$('.paymentMethod2').height(questionH);
			$('.question').height(questionH);
		}
	}

	function elementChangePosition() {

		if($('input[name="order-shipping_same_as_billing"]:checked').val() == 'on') {
			$('#payment_orig').html('');
			$('#payment_orig').css('display','none');
			$('#billing_orig').html(PAYMENT);
			$('#billing_orig legend').text('Payment Method');
			$('#billing_orig').removeClass('delivery');
			$('#billing_orig').removeClass('paymentMethod');
			$('#billing_orig').addClass('paymentMethod2');
		} else {
			$('#payment_orig').html(PAYMENT);
			$('#billing_orig').html(BILLING);
			$('#billing_orig').removeClass('paymentMethod2');
			$('#billing_orig').addClass('delivery');
			$('#billing_orig').addClass('paymentMethod');
			$('#billing_orig legend').text('Billing Address');
			$('#payment_orig').show();
		}

		//resizeInfos();
	}

</script>
{% endblock %}